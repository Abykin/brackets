define(function(require,exports,module){"use strict";var SpecRunnerUtils=brackets.getModule("spec/SpecRunnerUtils");var testWindow,PreferencesManager;describe("HealthData",function(){beforeEach(function(){SpecRunnerUtils.createTestWindowAndRun(this,function(w){testWindow=w})});afterEach(function(){SpecRunnerUtils.closeTestWindow();testWindow=null});describe("Data Send to Server",function(){var ONE_DAY=24*60*60*1e3,prefs,HealthDataManager;beforeEach(function(){PreferencesManager=testWindow.brackets.test.PreferencesManager;prefs=PreferencesManager.getExtensionPrefs("healthData");HealthDataManager=testWindow.brackets.test.HealthDataManager});afterEach(function(){HealthDataManager=null;prefs=null;PreferencesManager=null});it("should send data to server",function(){PreferencesManager.setViewState("lastTimeSentHealthData",Date.now()-ONE_DAY);PreferencesManager.setViewState("healthDataNotificationShown",true);var promise=HealthDataManager.checkHealthDataSend();waitsForDone(promise,"Send Data to Server",4e3)});it("should not send data to server",function(){PreferencesManager.setViewState("lastTimeSentHealthData",Date.now()-ONE_DAY);prefs.set("healthDataTracking",false);var promise=HealthDataManager.checkHealthDataSend();waitsForFail(promise,"Send Data to Server",4e3)})});describe("Notification is displayed",function(){var HealthDataNotification;beforeEach(function(){HealthDataNotification=testWindow.brackets.test.HealthDataNotification});afterEach(function(){HealthDataNotification=null});it("should show notification dialog",function(){HealthDataNotification.showDialogHealthDataNotification();expect($(testWindow.document).find(".health-data-notification.instance").length).toBe(1)})});describe("Health Data Statistics is displayed",function(){var HealthDataPreview;beforeEach(function(){HealthDataPreview=testWindow.brackets.test.HealthDataPreview});afterEach(function(){HealthDataPreview=null});it("should show file preview dialog",function(){runs(function(){var promise=HealthDataPreview.previewHealthData();waitsForDone(promise,"Health Data File Preview",4e3)});runs(function(){expect($(testWindow.document).find(".health-data-preview.instance").length).toBe(1)})})})})});